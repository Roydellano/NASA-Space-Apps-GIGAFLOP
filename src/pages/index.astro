---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import ArticleCard from '../components/ArticleCard.astro';
import { getSafeNewsCollection } from '../utils/newsLoader';

// Get all news articles and sort by date (newest first)
const allNews = await getSafeNewsCollection();
const sortedNews = allNews.sort((a: any, b: any) => 
  new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime()
);

// Get featured article (most recent high priority)
const featuredArticle = sortedNews.find((article: any) => article.data.priority === 'high') || sortedNews[0];
const regularArticles = sortedNews.filter((article: any) => article.slug !== featuredArticle.slug).slice(0, 9);
---

<Layout title="BioNauta - NASA Bioscience Research Explorer" description="Explore NASA's bioscience publications with AI-powered summaries. Discover insights from 608+ space biology experiments, identify knowledge gaps, and support mission planning.">
  <Header />
  
  <main>
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="container">
        <div class="hero-content">
          <h1 class="hero-title">
            Explore NASA's
            <span class="text-gradient">Bioscience Research</span>
            Universe
          </h1>
          <p class="hero-subtitle">
            AI-powered summaries of NASA's bioscience publications repository. 
            Discover experimental impacts, identify knowledge gaps, and gain actionable insights for space mission planning.
          </p>
          <div class="hero-stats">
            <div class="stat">
              <span class="stat-number">{sortedNews.length}+</span>
              <span class="stat-label">Publications</span>
            </div>
            <div class="stat">
              <span class="stat-number">608</span>
              <span class="stat-label">Total Studies</span>
            </div>
            <div class="stat">
              <span class="stat-number">3-5 min</span>
              <span class="stat-label">Read Time</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SpaceShip Section -->
    <section class="spaceship-section" style="margin-top: 10rem; margin-bottom: 5rem;">
      <div style="width: 100%; margin-top: 2rem;">
        <img src="/art/Spaceship.png" alt="Spaceship" style="width: 100%; height: auto; display: block;" />
      </div>
    </section>

    <!-- Featured Article -->
    {featuredArticle && (
      <section class="featured-section">
        <div class="container">
          <div class="section-header">
            <h2 class="section-title">Featured Research</h2>
            <div class="live-indicator">
              <span class="live-dot"></span>
              <span class="live-text">High Priority</span>
            </div>
          </div>
          <ArticleCard article={featuredArticle} featured={true} />
        </div>
      </section>
    )}

    <!-- Latest Articles -->
    <section class="articles-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Latest Publications</h2>
          <a href="/all" class="view-all-link">
            View all publications
            <svg class="view-all-icon" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </a>
        </div>
        
        <div class="articles-grid">
          {regularArticles.map((article: any) => (
            <ArticleCard article={article} />
          ))}
        </div>
      </div>
    </section>

    <!-- Newsletter Section -->
    {/* <section class="newsletter-section">
      <div class="container">
        <div class="newsletter-content">
          <h2 class="newsletter-title">Stay Updated on Space Biology</h2>
          <p class="newsletter-subtitle">
            Get the latest NASA bioscience research summaries delivered to your inbox. 
            Track scientific progress and mission-critical findings.
          </p>
          <form class="newsletter-form">
            <div class="form-group">
              <input 
                type="email" 
                placeholder="Coming soon" 
                class="newsletter-input"
                disabled
                required
              />
              <button type="submit" class="newsletter-button">
                Subscribe
              </button>
            </div>
            <p class="newsletter-disclaimer">
              By subscribing, you agree to our Privacy Policy and Terms of Service.
            </p>
          </form>
        </div>
      </div>
    </section> */}
  </main>

  <Footer />
</Layout>

